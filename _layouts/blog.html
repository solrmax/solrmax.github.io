<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="/assets/css/colors.css">
    <link rel="stylesheet" href="/assets/css/header.css">
    <link rel="stylesheet" href="/assets/css/footer.css">
    <link rel="stylesheet" href="/assets/css/blog.css">
    {% include head-custom.html %}
    <link rel="alternate" type="application/atom+xml" title="{{ site.title | escape }}" href="{{ site.feed.path | default: '/blog/feed.xml' | relative_url }}">
  </head>

  <body>
    <div class="blog-shell">

      <!-- Left column -->
      <aside class="blog-sidebar">
        <div class="blog-sidebar-inner">
          <header>
            <div class="container intro-section">
              <a id="a-title" href="{{ '/blog' | relative_url }}">
                <h1 class="intro-title">{{ site.title }}</h1>
              </a>
              <h2 class="intro-subtitle">
                {{ site.author.name }} — {{ site.author.title }}
              </h2>
              <p class="intro-bio">
                {{ site.author.description }}
              </p>
              <div class="intro-links">
                {% for social in site.socials %}
                  <a href="{{ social.url }}" {% unless social.inTab %} target="_blank" {% endunless %} class="intro-icon {{ social.name }}">
                    <img src="/assets/icons/socials/s_{{ social.name }}.svg">
                  </a>
                {% endfor %}
              </div>
            </div>

            {% if site.show_navigation %}
              <div class="container">
                {% include navigation.html %}
              </div>
            {% endif %}
          </header>

          <nav class="blog-tools">
            <!-- Categories dropdown -->
            <div class="blog-tool-group" data-dropdown="categories">
              <button
                class="blog-tool blog-tool-toggle"
                type="button"
                aria-expanded="false"
                aria-controls="blog-dropdown-categories"
              >
                Categories
                <span class="blog-tool-caret">▾</span>
              </button>

              <div class="blog-dropdown" id="blog-dropdown-categories">
                {% if site.categories %}
                  {% capture cats_with_counts %}
                    {% for cat in site.categories %}
                      {% assign cat_name = cat[0] %}
                      {% assign cat_size = cat[1].size %}
                      {% assign inv = 1000 | minus: cat_size %}
                      {% if inv < 10 %}
                        000{{ inv }}
                      {% elsif inv < 100 %}
                        00{{ inv }}
                      {% elsif inv < 1000 %}
                        0{{ inv }}
                      {% else %}
                        {{ inv }}
                      {% endif %},{{ cat_name }}@
                    {% endfor %}
                  {% endcapture %}

                  {% assign cats_array = cats_with_counts | split: '@' | sort %}

                  <ul class="blog-dropdown-list">
                    {% for cat_entry in cats_array %}
                      {% if cat_entry == '' %}
                        {% continue %}
                      {% endif %}

                      {% assign parts    = cat_entry | split: ',' %}
                      {% assign cat_name = parts[1] | strip %}
                      {% if cat_name == '' %}
                        {% continue %}
                      {% endif %}

                      {% assign inv_str   = parts[0] | strip %}
                      {% assign inv       = inv_str | plus: 0 %}
                      {% assign cat_count = 1000 | minus: inv %}

                      <li class="blog-dropdown-item">
                        <a
                          class="blog-dropdown-link"
                          href="{{ '/blog/categories' | relative_url }}#category-{{ cat_name | slugify }}"
                        >
                          <span class="blog-label">{{ cat_name }}</span>
                          <span class="blog-count">{{ cat_count }}</span>
                        </a>
                      </li>
                    {% endfor %}
                  </ul>

                {% else %}
                  <p class="blog-dropdown-empty">No categories yet.</p>
                {% endif %}
              </div>
            </div>

            <!-- Tags dropdown -->
            <div class="blog-tool-group" data-dropdown="tags">
              <button
                class="blog-tool blog-tool-toggle"
                type="button"
                aria-expanded="false"
                aria-controls="blog-dropdown-tags"
              >
                Tags
                <span class="blog-tool-caret">▾</span>
              </button>

              <div class="blog-dropdown" id="blog-dropdown-tags">
                {% if site.tags %}
                  {% capture tags_with_counts %}
                    {% for tag in site.tags %}
                      {% assign tag_name = tag[0] %}
                      {% assign tag_size = tag[1].size %}

                      {% assign inv = 1000 | minus: tag_size %}
                      {% if inv < 10 %}
                        000{{ inv }}
                      {% elsif inv < 100 %}
                        00{{ inv }}
                      {% elsif inv < 1000 %}
                        0{{ inv }}
                      {% else %}
                        {{ inv }}
                      {% endif %},{{ tag_name }}@
                    {% endfor %}
                  {% endcapture %}

                  {% assign tags_array = tags_with_counts | split: '@' | sort %}

                  <ul class="blog-dropdown-list">
                    {% for tag_entry in tags_array %}
                      {% if tag_entry == '' %}
                        {% continue %}
                      {% endif %}

                      {% assign parts    = tag_entry | split: ',' %}
                      {% assign tag_name = parts[1] | strip %}
                      {% if tag_name == '' %}
                        {% continue %}
                      {% endif %}

                      {% assign inv_str   = parts[0] | strip %}
                      {% assign inv       = inv_str | plus: 0 %}
                      {% assign tag_count = 1000 | minus: inv %}

                      <li class="blog-dropdown-item">
                        <a
                          class="blog-dropdown-link"
                          href="{{ '/blog/tags' | relative_url }}#tag-{{ tag_name | slugify }}"
                        >
                          <span class="blog-label">{{ tag_name }}</span>
                          <span class="blog-count">{{ tag_count }}</span>
                        </a>
                      </li>
                    {% endfor %}
                  </ul>

                {% else %}
                  <p class="blog-dropdown-empty">No tags yet.</p>
                {% endif %}
              </div>
            </div>

            <!-- Archive dropdown -->
            <div class="blog-tool-group" data-dropdown="archive">
              <button
                class="blog-tool blog-tool-toggle"
                type="button"
                aria-expanded="false"
                aria-controls="blog-dropdown-archive"
              >
                Archive
                <span class="blog-tool-caret">▾</span>
              </button>

              <div class="blog-dropdown" id="blog-dropdown-archive">
                {% if site.posts and site.posts != empty %}
                  {% assign posts_by_month = site.posts
                    | group_by_exp: 'post', 'post.date | date: "%Y-%m"'
                    | sort: 'name'
                    | reverse %}
                  <ul class="blog-dropdown-list">
                    {% for month in posts_by_month %}
                      {% assign first_post = month.items | first %}
                      <li class="blog-dropdown-item">
                        <a
                          class="blog-dropdown-link"
                          href="{{ '/blog/archive' | relative_url }}#archive-{{ month.name }}"
                        >
                          <span class="blog-label">
                            {{ first_post.date | date: "%B %Y" }}
                          </span>
                          <span class="blog-count">{{ month.items | size }}</span>
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                {% else %}
                  <p class="blog-dropdown-empty">No posts yet.</p>
                {% endif %}
              </div>
            </div>
          </nav>

          <div class="blog-bottom">
            <section class="blog-rss">
              <h2 class="blog-rss-title">
                <a
                  href="{{ site.feed.path | default: '/blog/feed.xml' | relative_url }}"
                  target="_blank"
                  class="blog-rss-link"
                >
                  SUBSCRIBE BY RSS
                  <img
                    src="https://rss.com/blog/wp-content/uploads/2019/10/social_style_3_rss-512-1.png"
                    alt="RSS icon"
                    class="blog-rss-icon"
                  >
                </a>
              </h2>
            </section>


            <section class="blog-subscribe">
              <h2 class="blog-subscribe-title">Subscribe by email</h2>
              <p class="blog-subscribe-text">
                Get new devlogs and posts in your inbox. No spam, unsubscribe anytime.
              </p>

              <form
                action="https://github.us4.list-manage.com/subscribe/post?u=3b3a1bc85650ad0bc7cad3f43&amp;id=451d0f9f10&amp;f_id=007ddbedf0"
                method="post"
                id="mc-embedded-subscribe-form"
                name="mc-embedded-subscribe-form"
                target="_blank"
                novalidate
                class="blog-subscribe-form validate"
              >
                <label for="mce-EMAIL" class="blog-subscribe-label">
                  Email address
                </label>

                <div class="blog-subscribe-row">
                  <input
                    type="email"
                    name="EMAIL"
                    class="blog-subscribe-input required email"
                    id="mce-EMAIL"
                    placeholder="you@example.com"
                    required
                    value=""
                  >
                  <button
                    type="submit"
                    name="subscribe"
                    id="mc-embedded-subscribe"
                    class="blog-subscribe-button"
                  >
                    Subscribe
                  </button>
                </div>

                <!-- Response messages -->
                <div id="mce-responses" class="blog-subscribe-responses">
                  <div class="response" id="mce-error-response" style="display:none"></div>
                  <div class="response" id="mce-success-response" style="display:none"></div>
                </div>

                <!-- Honeypot field (Mailchimp anti-bot) -->
                <div style="position: absolute; left: -5000px;" aria-hidden="true">
                  <input
                    type="text"
                    name="b_3b3a1bc85650ad0bc7cad3f43_451d0f9f10"
                    tabindex="-1"
                    value=""
                  >
                </div>
              </form>
            </section>
          </div>
        </div>

        <footer>
          <div class="container site-footer">
            <p class="footer-text">
              © {{ "now" | date: "%Y" }} {{ site.author.name }} <br>
              Built with 
              <a class="footer-link" href="https://jekyllrb.com/" target="_blank">Jekyll</a>, 
              the <a class="footer-link" href="https://github.com/pages-themes/hacker" target="_blank">Hacker theme</a>, 
              and <a class="footer-link" href="https://chatgpt.com" target="_blank">AI assistance</a>.
            </p>
          </div>
        </footer>
      </aside>

      <!-- Right column -->
      <div class="container page-content">
        <section id="main_content">
          {{ content }}
        </section>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        var toggles = document.querySelectorAll('.blog-tool-toggle');

        toggles.forEach(function (toggle) {
          var group = toggle.closest('.blog-tool-group');
          if (!group) return;

          toggle.addEventListener('click', function (e) {
            e.preventDefault();

            var isOpen = group.classList.toggle('is-open');
            toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          });
        });
      });
    </script>

    {% include script-custom.html %}
  </body>
</html>
